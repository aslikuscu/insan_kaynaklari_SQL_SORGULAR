--sirkette calisan departman bazli kadin ve erkek sayisini getir


select DEPARTMENT,
(select count(*) from HR.dbo.PERSONN where DEPARTMENTID=d.ID and GENDER = 'E' and OUTDATE is not NULL) as male_count,
(select count(*) from HR.dbo.PERSONN where DEPARTMENTID=d.ID and GENDER = 'K' and OUTDATE is not NULL) as female_count,
(select count(*) from HR.dbo.PERSONN where DEPARTMENTID=d.ID and OUTDATE is not NULL) as total_person_count
from HR.dbo.DEPARTMENT as d
order by d.DEPARTMENT


select*from HR.dbo.PERSONN

select* from HR.dbo.PERSONN
